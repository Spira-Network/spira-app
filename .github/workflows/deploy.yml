name: Production Deployment

concurrency:
    group: production
    cancel-in-progress: true

on:
    push:
        branches: [main]

jobs:
    deployment:
        name: Deploy to production
        runs-on: ubuntu-latest
        if: github.ref == 'refs/heads/main'

        steps:
            - name: Checkout repo
              uses: actions/checkout@v4

            - name: Deploy to Vercel
              uses: amondnet/vercel-action@v25
              with:
                  vercel-token: ${{ secrets.VERCEL_TOKEN }}
                  vercel-org-id: ${{ secrets.VERCEL_ORG_ID }}
                  vercel-project-id: ${{ secrets.VERCEL_PROJECT_ID }}
                  vercel-args: '--prod'

            - name: Create GitHub deployment
              uses: chrnorm/deployment-action@v2
              id: deployment
              with:
                  token: '${{ secrets.GITHUB_TOKEN }}'
                  target_url: https:/spira.network
                  environment: production
